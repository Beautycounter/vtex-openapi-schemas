{
    "openapi": "3.0.0",
    "info": {
        "title": "VTEX Intelligent Search Events API - Headless",
        "description": "Intelligent Search Events API is responsible for collecting the search events to improve our search results, such as page interactions and conversion. Some of the features improved by this collection are the possibility to sort the products by clicks or record the top search in the autocomplete.\r\n\r\n >⚠️ **This API applies only to Headless scenarios**. It doesn't apply to stores using VTEX's storefront solution, natively integrated with Intelligent Search.",
        "contact": {},
        "version": "1.0"
    },
    "servers": [
        {
            "url": "https://sp.vtex.com/event-api/v1/{account}",
            "description": "Server URL.",
            "variables": {
                "account": {
                    "default": "account",
                    "description": "Name of the VTEX account. Used as part of the URL."
                }
            }
        }
    ],
    "paths": {
        "/event": {
            "post": {
                "summary": "Save Events",
                "description": "",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "example": {
                                "session": "zZlNhqz1vFJP6iPG5Oqtt",
                                "anonymous": "Om1TNluGvgmSgU5OOTvkkd",
                                "url": "https://example.com/search/?query=zapatilha",
                                "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0",
                                "type": "search.query",
                                "text": "zapatilha",
                                "misspelled": true,
                                "match": 392,
                                "operator": "and"
                            },
                            "schema": {
                                "oneOf": [
                                    {
                                        "$ref": "#/components/schemas/SessionPing"
                                    },
                                    {
                                        "$ref": "#/components/schemas/PageCart"
                                    },
                                    {
                                        "$ref": "#/components/schemas/PageEmptyCart"
                                    },
                                    {
                                        "$ref": "#/components/schemas/PageConfirmation"
                                    },
                                    {
                                        "$ref": "#/components/schemas/Click"
                                    },
                                    {
                                        "$ref": "#/components/schemas/Query"
                                    }
                                ]
                            }
                        }
                    }
                },
                "tags": [
                    "Events"
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "SessionPing": {
                "type": "object",
                "properties": {
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "Type of event, which can be one of the following: page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click.",
                        "example": "session.ping"
                    },
                    "userAgent": {
                        "type": "string",
                        "title": "userAgent",
                        "description": "Identifies whether the request came from a mobile or desktop application. It's used as a filter in the search report.",
                        "default": "desktop",
                        "example": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0"
                    },
                    "anonymous": {
                        "type": "string",
                        "title": "anonymous",
                        "description": "Identifier related to related to the user, according to the [nanoid](https://github.com/ai/nanoid) pattern. This information is kept in storage for one year.",
                        "example": "Om1TNluGvgmSgU5OOTvkkd"
                    },
                    "session": {
                        "type": "string",
                        "title": "session",
                        "description": "Identifier related to the current navigation, according to the [nanoid](https://github.com/ai/nanoid) pattern. It is a cookie that lasts for 30 minutes, changing if the user opens another tab in private navigation mode.",
                        "example": "zZlNhqz1vFJP6iPG5Oqtt"
                    }
                },
                "example": {
                    "type": "session.ping",
                    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
                    "anonymous": "1ce47e50-3f10-4556-95d3-57d4881c03a4",
                    "session": "ee15a2ad-d2f1-4a29-995e-e514b468385e"
                }
            },
            "PageCart": {
                "type": "object",
                "properties": {
                    "anonymous": {
                        "type": "string",
                        "title": "anonymous",
                        "description": "Identifier related to related to the user, according to the [nanoid](https://github.com/ai/nanoid) pattern. This information is kept in storage for one year.",
                        "example": "Om1TNluGvgmSgU5OOTvkkd"
                    },
                    "session": {
                        "type": "string",
                        "title": "session",
                        "description": "Identifier related to the current navigation, according to the [nanoid](https://github.com/ai/nanoid) pattern. It is a cookie that lasts for 30 minutes, changing if the user opens another tab in private navigation mode.",
                        "example": "zZlNhqz1vFJP6iPG5Oqtt"
                    },
                    "products": {
                        "type": "array",
                        "title": "products",
                        "description": "Array of objects containing products. If the type is page.cart, the array contains all the products in the cart, with their ID and quantity. If there are no products in the cart (page.empty_cart), the array is empty. If the type is page.confirmation, the array contains all the products that were purchased, with their ID, price and quantity.",
                        "example": [],
                        "items": {
                            "$ref": "#/components/schemas/CartProduct"
                        }
                    },
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "Type of event, which can be one of the following: page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click.",
                        "example": "page.cart"
                    }
                }
            },
            "PageEmptyCart": {
                "type": "object",
                "properties": {
                    "anonymous": {
                        "type": "string",
                        "title": "anonymous",
                        "description": "Identifier related to related to the user, according to the [nanoid](https://github.com/ai/nanoid) pattern. This information is kept in storage for one year.",
                        "example": "Om1TNluGvgmSgU5OOTvkkd"
                    },
                    "session": {
                        "type": "string",
                        "title": "session",
                        "description": "Identifier related to the current navigation, according to the [nanoid](https://github.com/ai/nanoid) pattern. It is a cookie that lasts for 30 minutes, changing if the user opens another tab in private navigation mode.",
                        "example": "zZlNhqz1vFJP6iPG5Oqtt"
                    },
                    "products": {
                        "type": "array",
                        "title": "products",
                        "description": "Array of objects containing products. If the type is page.cart, the array contains all the products in the cart, with their ID and quantity. If there are no products in the cart (page.empty_cart), the array is empty. If the type is page.confirmation, the array contains all the products that were purchased, with their ID, price and quantity.",
                        "example": [
                            {
                                "productId": "ABC123",
                                "quantity": 2
                            }
                        ],
                        "items": {
                            "$ref": "#/components/schemas/CartProduct"
                        }
                    },
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "Type of event, which can be one of the following: page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click.",
                        "example": "page.empty_cart"
                    }
                }
            },
            "PageConfirmation": {
                "type": "object",
                "properties": {
                    "products": {
                        "type": "array",
                        "title": "products",
                        "description": "Array of objects containing products. If the type is page.cart, the array contains all the products in the cart, with their ID and quantity. If there are no products in the cart (page.empty_cart), the array is empty. If the type is page.confirmation, the array contains all the products that were purchased, with their ID, price and quantity.",
                        "example": [
                            {
                                "productId": "ABC123",
                                "price": 9.99,
                                "quantity": 3
                            }
                        ],
                        "items": {
                            "$ref": "#/components/schemas/OrderProduct"
                        }
                    },
                    "order": {
                        "type": "string",
                        "title": "order",
                        "description": "Order ID.",
                        "example": "123ABC"
                    },
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "Type of event, which can be one of the following: page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click.",
                        "example": "page.confirmation"
                    }
                }
            },
            "Click": {
                "type": "object",
                "properties": {
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "Type of event, which can be one of the following: page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click.",
                        "example": "search.click"
                    },
                    "productId": {
                        "type": "string",
                        "description": "The unique identifier of the clicked product."
                    },
                    "position": {
                        "type": "integer",
                        "description": "Position of the clicked product on the search results page."
                    },
                    "url": {
                        "type": "string",
                        "title": "url",
                        "description": "URL that identifies from which page the event occurred.",
                        "example": "https://example.com/s?q=pneu&sort=score_desc&page=0"
                    },
                    "text": {
                        "type": "string",
                        "title": "text",
                        "description": "The query used in the search.",
                        "example": "tv"
                    },
                    "userAgent": {
                        "type": "string",
                        "title": "userAgent",
                        "description": "Identifies whether the request came from a mobile or desktop application. It's used as a filter in the search report.",
                        "default": "desktop",
                        "example": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0"
                    },
                    "anonymous": {
                        "type": "string",
                        "title": "anonymous",
                        "description": "Identifier related to related to the user, according to the [nanoid](https://github.com/ai/nanoid) pattern. This information is kept in storage for one year.",
                        "example": "Om1TNluGvgmSgU5OOTvkkd"
                    },
                    "session": {
                        "type": "string",
                        "title": "session",
                        "description": "Identifier related to the current navigation, according to the [nanoid](https://github.com/ai/nanoid) pattern. It is a cookie that lasts for 30 minutes, changing if the user opens another tab in private navigation mode.",
                        "example": "zZlNhqz1vFJP6iPG5Oqtt"
                    }
                },
                "example": {
                    "type": "search.click",
                    "productId": "12345",
                    "position": 1,
                    "url": "https://example.com/s?q=pneu&sort=score_desc&page=0",
                    "text": "pneu",
                    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
                    "anonymous": "1ce47e50-3f10-4556-95d3-57d4881c03a4",
                    "session": "51a53ce3-096d-4740-a6d0-3cf86085ba13"
                }
            },
            "Query": {
                "type": "object",
                "properties": {
                    "session": {
                        "type": "string",
                        "title": "session",
                        "description": "Identifier related to the current navigation, according to the [nanoid](https://github.com/ai/nanoid) pattern. It is a cookie that lasts for 30 minutes, changing if the user opens another tab in private navigation mode.",
                        "example": "zZlNhqz1vFJP6iPG5Oqtt"
                    },
                    "anonymous": {
                        "type": "string",
                        "title": "anonymous",
                        "description": "Identifier related to related to the user, according to the [nanoid](https://github.com/ai/nanoid) pattern. This information is kept in storage for one year.",
                        "example": "Om1TNluGvgmSgU5OOTvkkd"
                    },
                    "url": {
                        "type": "string",
                        "title": "url",
                        "description": "URL that identifies from which page the event occurred.",
                        "example": "https://example.com/search/?query=zapatilha"
                    },
                    "agent": {
                        "type": "string",
                        "title": "agent",
                        "description": "the goal is to identify whether the request came from a mobile or desktop application. It's used as a filter in the search report. The default value is desktop.",
                        "default": "desktop",
                        "example": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0"
                    },
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "Type of event, which can be one of the following: page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click.",
                        "example": "search.query"
                    },
                    "text": {
                        "type": "string",
                        "title": "text",
                        "description": "The query used in the search.",
                        "example": "tv"
                    },
                    "misspelled": {
                        "type": "boolean",
                        "title": "misspelled",
                        "description": "Indicates whether the query has a typo (`true`) or not (`false`).",
                        "example": true
                    },
                    "match": {
                        "type": "number",
                        "title": "match",
                        "description": "Amount of products retrieved by the search.",
                        "example": 396
                    },
                    "operator": {
                        "type": "string",
                        "title": "operator",
                        "description": " the type of operator used on the search. [more details](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html). Possible values: and, or.",
                        "example": "and"
                    }
                },
                "example": {
                    "session": "zZlNhqz1vFJP6iPG5Oqtt",
                    "anonymous": "Om1TNluGvgmSgU5OOTvkkd",
                    "url": "https://example.com/search/?query=zapatilha",
                    "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0",
                    "type": "search.query",
                    "text": "zapatilha",
                    "misspelled": true,
                    "match": 392,
                    "operator": "and"
                }
            },
            "CartProduct": {
                "type": "object",
                "properties": {
                    "productId": {
                        "type": "string",
                        "description": "The unique identifier of the product."
                    },
                    "quantity": {
                        "type": "number",
                        "description": "The quantity of the product."
                    }
                },
                "required": [
                    "productId",
                    "quantity"
                ],
                "example": {
                    "productId": "ABC123",
                    "quantity": 2
                }
            },
            "OrderProduct": {
                "type": "object",
                "properties": {
                    "productId": {
                        "type": "string",
                        "description": "The unique identifier of the product."
                    },
                    "price": {
                        "type": "number",
                        "description": "The price of the product."
                    },
                    "quantity": {
                        "type": "number",
                        "description": "The quantity of the product.",
                        "default": 1
                    }
                },
                "required": [
                    "productId",
                    "price"
                ],
                "example": {
                    "productId": "ABC123",
                    "price": 9.99,
                    "quantity": 3
                }
            }
        }
    },
    "tags": [
        {
            "name": "Events"
        }
    ]
}