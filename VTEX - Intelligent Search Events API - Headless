{
    "openapi": "3.0.0",
    "info": {
        "title": "VTEX Intelligent Search Events API - Headless",
        "description": "Intelligent Search Events API is responsible for collecting the search events to improve our search results, such as page interactions and conversion. Some of the features improved by this collection are the possibility to sort the products by clicks or record the top search in the autocomplete.\r\n\r\n >⚠️ **This API applies only to Headless scenarios**. It doesn't apply to stores using VTEX's storefront solution, natively integrated with Intelligent Search.",
        "contact": {},
        "version": "1.0"
    },
    "servers": [
        {
            "url": "https://sp.vtex.com/event-api/v1/{account}",
            "description": "Server URL.",
            "variables": {
                "account": {
                    "default": "account",
                    "description": "Name of the VTEX account. Used as part of the URL."
                }
            }
        }
    ],
    "paths": {
        "/event": {
            "post": {
                "summary": "Save Events",
                "description": "",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "example": {
                                "session": "zZlNhqz1vFJP6iPG5Oqtt",
                                "anonymous": "Om1TNluGvgmSgU5OOTvkkd",
                                "url": "https://example.com/search/?query=zapatilha",
                                "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0",
                                "type": "search.query",
                                "text": "zapatilha",
                                "misspelled": true,
                                "match": 392,
                                "operator": "and"
                            },
                            "schema": {
                                "type": "object",
                                "required": [
                                    "session",
                                    "anonymous",
                                    "type",
                                    "text",
                                    "misspelled",
                                    "match",
                                    "operator"
                                ],
                                "properties": {
                                    "session": {
                                        "type": "string",
                                        "title": "session",
                                        "description": "Identifier related to the current navigation, according to the [nanoid](https://github.com/ai/nanoid) pattern. It is a cookie that lasts for 30 minutes, changing if the user opens another tab in private navigation mode.",
                                        "example": "zZlNhqz1vFJP6iPG5Oqtt"
                                    },
                                    "anonymous": {
                                        "type": "string",
                                        "title": "anonymous",
                                        "description": "Identifier related to related to the user, according to the [nanoid](https://github.com/ai/nanoid) pattern. This information is kept in storage for one year.",
                                        "example": "Om1TNluGvgmSgU5OOTvkkd"
                                    },
                                    "productId": {
                                        "type": "string",
                                        "title": "productId",
                                        "description": "Unique identifier of the clicked product.",
                                        "example": "32581"
                                    },
                                    "position": {
                                        "type": "integer",
                                        "title": "position",
                                        "description": "Position of the clicked product in the search results page.",
                                        "example": 1
                                    },
                                    "url": {
                                        "type": "string",
                                        "title": "url",
                                        "description": "the goal identifies from which page the event occurred.",
                                        "example": "https://example.com/search/?query=zapatilha"
                                    },
                                    "agent": {
                                        "type": "string",
                                        "title": "agent",
                                        "description": "the goal is to identify whether the request came from a mobile or desktop application. It's used as a filter in the search report. The default value is desktop.",
                                        "default": "desktop",
                                        "example": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0"
                                    },
                                    "products": {
                                        "type": "array",
                                        "title": "products",
                                        "description": "Array of objects containing products. If the type is page.cart, the array contains all the products in the cart, with their ID and quantity. If there are no products in the cart (page.empty_cart), the array is empty. If the type is page.confirmation, the array contains all the products that were purchased, with their ID, price and quantity.",
                                        "example": "",
                                        "items": {
                                            "type": "object",
                                            "parameters": {
                                                "oneOf": [
                                                    {
                                                        "$ref": "#/components/schemas/CartProduct"
                                                    },
                                                    {
                                                        "$ref": "#/components/schemas/OrderProduct"
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "order": {
                                        "type": "string",
                                        "title": "order",
                                        "description": "Order ID.",
                                        "example": "123ABC"
                                    },
                                    "type": {
                                        "type": "",
                                        "title": "",
                                        "description": "page.cart, page.empty_cart, search.query, page.confirmation, session.ping, search.click",
                                        "example": "search.query"
                                    },
                                    "text": {
                                        "type": "string",
                                        "title": "text",
                                        "description": "the query used.",
                                        "example": ""
                                    },
                                    "misspelled": {
                                        "type": "boolean",
                                        "title": "misspelled",
                                        "description": "it's a boolean to indicate whether the query has a typo.",
                                        "example": true
                                    },
                                    "match": {
                                        "type": "number",
                                        "title": "",
                                        "description": "it's how many products were retrieved by the search.",
                                        "example": ""
                                    },
                                    "operator": {
                                        "type": "string",
                                        "title": "",
                                        "description": " the type of operator used on the search. [more details](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html). Possible values: and, or.",
                                        "example": "and"
                                    }
                                }
                            }
                        }
                    }
                },
                "tags": [
                    "Events"
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "CartProduct": {
                "type": "object",
                "properties": {
                    "productId": {
                        "type": "string",
                        "description": "The unique identifier of the product."
                    },
                    "quantity": {
                        "type": "number",
                        "description": "The quantity of the product."
                    }
                },
                "required": [
                    "productId",
                    "quantity"
                ],
                "example": {
                    "productId": "ABC123",
                    "quantity": 2
                }
            },
            "OrderProduct": {
                "type": "object",
                "properties": {
                    "productId": {
                        "type": "string",
                        "description": "The unique identifier of the product."
                    },
                    "price": {
                        "type": "number",
                        "description": "The price of the product."
                    },
                    "quantity": {
                        "type": "number",
                        "description": "The quantity of the product.",
                        "default": 1
                    }
                },
                "required": [
                    "productId",
                    "price"
                ],
                "example": {
                    "productId": "ABC123",
                    "price": 9.99,
                    "quantity": 3
                }
            }
        }
    },
    "tags": [
        "Events"
    ]
}